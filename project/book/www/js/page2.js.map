{"version":3,"sources":["page2.es6"],"names":[],"mappings":"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","file":"page2.js","sourcesContent":["var PAGE2 = {\n\t//之前的页面\n\tfrom:\"\",\n\t//当前书籍地址\n\turl:\"\",\n\t//当前书名\n\tname:\"\",\n\t//当前书籍是否加入收藏\n\thasAdd:\"\",\n\t//当前书籍未读的章节dom\n\tnotReadFirstDom:0,\n\t//页面初始化\n\tasync init(url,name,from){\n\t\tthis.name = name;\n\t\tthis.url = url;\n\t\tthis.from = from;\n\n\t\tawait this.clearOldData();\n\t\tawait this.bindData();\n\t\tawait this.scrollToNotReadList();\n\t\tawait this.bindEvent();\n\t\tawait this.show();\n\t},\n\t//显示\n\tshow(){\n\t\tlet dom = $(\"#page2\"),\n\t\t\twin_width = window.innerWidth,\n\t\t\t_this = this;\n\n\t\treturn new Promise(function(success,error){\n\t\t\tdom.css3({\n\t\t\t\ttransform:\"translateX(\"+win_width+\"px)\",\n\t\t\t\tdisplay:\"box\"\n\t\t\t});\n\n\t\t\tdom.cssAnimate({\n\t\t\t\ttransform:\"translateX(0)\"\n\t\t\t},500,function(){\n\t\t\t\t$(\"#\"+_this.from).css({display:\"none\"});\n\t\t\t\tsuccess();\n\t\t\t})\n\t\t});\n\n\n\t},\n\t//隐藏\n\thide(){\n\t\tlet dom = $(\"#page2\"),\n\t\t\twin_width = window.innerWidth,\n\t\t\t_this = this;\n\n\t\treturn new Promise(function(success,error){\n\t\t\t$(\"#\"+_this.from).css3({display:\"box\"});\n\t\t\tdom.cssAnimate({\n\t\t\t\ttransform:\"translateX(\"+win_width+\"px)\"\n\t\t\t},500,function(){\n\t\t\t\tdom.css({display:\"none\"});\n\t\t\t\tsuccess();\n\t\t\t})\n\t\t});\n\t},\n\t//清空数据\n\tclearOldData(){\n\t\tlet dom = $(\"#page2_body\"),\n\t\t\tlist = dom.find(\".page2_list_item\"),\n\t\t\tback = $(\"#page2_back\"),\n\t\t\tadd = $(\"#page2_add\");\n\n\t\t$$(list).unbind(true);\n\t\t$$(back).unbind(true);\n\t\t$$(add).unbind(true);\n\t\tdom.html(\"\");\n\t},\n\t//绑定数据\n\tbindData(){\n\t\tlet bookDir = DATA.booksDir[this.url] || [],\n\t\t\thasReadUrl = DATA.hasRead[this.url],\n\t\t\tbookName = this.name,\n\t\t\thasAdd = this.checkBookHasAdd(),\n\t\t\tdom = $(\"#page2\");\n\n\t\tthis.hasAdd = hasAdd;\n\n\t\tdom.find(\".page2_header\").find(\".diandian\").text(bookName);\n\t\tif(hasAdd){\n\t\t\tdom.find(\".page2_header\").find(\".right\").text(\"\");\n\t\t}else{\n\t\t\tdom.find(\".page2_header\").find(\".right\").html(\"&#xe62b;\");\n\t\t}\n\n\n\t\tlet body = $(\"#page2_body\"),\n\t\t\tlist = $(\"#page2_list_item\"),\n\t\t\tisRead = (hasReadUrl)? true : false,\n\t\t\tnotReadFirstDom = 0;\n\n\t\tfor(let i=0,l=bookDir.length;i<l;i++){\n\t\t\tlet this_list = list.clone().css({display:\"block\"}).attr({id:\"\"}),\n\t\t\t\tthis_data = bookDir[i],\n\t\t\t\tthis_name = this_data.name,\n\t\t\t\tthis_url = this_data.url;\n\n\t\t\tthis_list.data({\n\t\t\t\turl:this_url,\n\t\t\t\tn:i\n\t\t\t});\n\t\t\tthis_list.text(this_name);\n\t\t\tif(isRead){\n\t\t\t\tthis_list.addClass(\"isRead\");\n\t\t\t}\n\n\t\t\tif(this_url == hasReadUrl){\n\t\t\t\tisRead = false;\n\t\t\t\tnotReadFirstDom = i;\n\t\t\t}\n\n\t\t\tbody.append(this_list);\n\t\t}\n\n\t\tthis.notReadFirstDom = notReadFirstDom;\n\n\t},\n\t//滚动到第一个未读的章节\n\tscrollToNotReadList(){\n\t\tlet domNumber = this.notReadFirstDom,\n\t\t\tlistHeight = $(\"#page2_list_item\").height()+1,\n\t\t\tbody = $(\"#page2_body\");\n\n\n\t\tlet top = domNumber*listHeight;\n\t\tbody.animate({scrollTop:top+\"px\"},300);\n\n\t},\n\t//检查是否已添加至收藏\n\tcheckBookHasAdd(){\n\t\tlet books = DATA.books,\n\t\t\thasAdd = false;\n\n\t\tfor(let i=0,l=books.length;i<l;i++){\n\t\t\tvar this_name = books[i].url;\n\t\t\tif(this_name == this.url){\n\t\t\t\thasAdd = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\treturn hasAdd;\n\t},\n\t//绑定事件\n\tbindEvent(){\n\t\tlet back = $(\"#page2_back\"),\n\t\t\tadd = $(\"#page2_add\"),\n\t\t\tlist = $(\"#page2_body\").find(\".page2_list_item\"),\n\t\t\t_this = this;\n\n\t\t$$(back).myclickok(function(){\n\t\t\t_this.hide();\n\t\t});\n\n\t\t$$(add).myclickok(function(){\n\t\t\t_this.addBook();\n\t\t});\n\n\t\t$$(list).myclickok(function(){\n\t\t\tvar url = $(this).data(\"url\"),\n\t\t\t\tname = $(this).text(),\n\t\t\t\tn = $(this).data(\"n\");\n\n\t\t\t_this.openInfo(url,name,n);\n\t\t});\n\n\t},\n\t//添加书籍\n\taddBook(){\n\t\tlet name = $(\"#page2\").find(\".page2_header\").find(\".diandian\").text(),\n\t\t\turl = this.url,\n\t\t\tdata = DATA.books;\n\n\t\tdata.push({\n\t\t\tname:name,\n\t\t\turl:url\n\t\t});\n\n\t\tlet localData = JSON.parse(DEVICE.localData.getItem(\"cache\") || '{}');\n\t\tlocalData.books = data;\n\t\tDEVICE.localData.setItem(\"cache\",JSON.stringify(localData));\n\n\n\n\t\tlet bookDir = JSON.parse(DEVICE.localData.getItem(\"bookDir\") || '{}');\n\t\tlet this_dir = DATA.booksDir[url];\n\t\tbookDir[url] = this_dir;\n\t\tDEVICE.localData.setItem(\"bookDir\",JSON.stringify(bookDir));\n\n\n\t\t$(\"#page2\").find(\".page2_header\").find(\".right\").text(\"\");\n\n\t\tPAGE1.refreshDir();\n\n\t\tDEVICE.info.show(\"添加成功!\",true);\n\t},\n\t//打开章节详细\n\topenInfo(url,name,n){\n\t\tvar bookUrl = this.url,\n\t\t\tinfoUrl = url,\n\t\t\tinfoName = name;\n\n\t\tPAGE3\n\t\t\t.init(bookUrl,infoUrl,infoName,\"page2\",n)\n\t\t\t.catch(function(e){\n\t\t\t\tDEVICE.info.show(\"获取数据失败!\");\n\t\t\t});\n\t},\n\t//标示n之前章节为已读\n\tlistShowHasRead(n){\n\t\tvar nowList = $(\"#page2_body\").find(\".page2_list_item\").eq(n);\n\t\tnowList.prevAll().addClass(\"isRead\");\n\t\tnowList.addClass(\"isRead\");\n\t}\n};"]}