{"version":3,"sources":["page1.es6"],"names":[],"mappings":"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","file":"page1.js","sourcesContent":["var PAGE1 = {\n\n\t//初始执行\n\tasync init(){\n\t\tawait this.bindEvent();\n\t\tlet userData =  await this.getLocalUserData();\n\t\tDATA.books = userData.books;\n\t\tDATA.hasRead = userData.hasRead;\n\t\tlet bookDir = await this.getLocalBookDirData();\n\t\tDATA.booksDir = bookDir;\n\n\t\tawait this.createList();\n\t\tawait this.checkAbnormalClose();\n\t},\n\n\t//更新按钮触发\n\tasync getNewData(){\n\t\tlet newBookDir =    await this.getNewBookDirData();\n\t\tnewBookDir =        await this.reCreateNewBookDirData(newBookDir);\n\t\tlet oldBookDir =    await this.getLocalBookDirData();\n\t\tawait this.saveNewBookDirData(oldBookDir,newBookDir);\n\n\t\tDEVICE.info.show(\"更新成功!\",true);\n\n\t\tsetTimeout(function(){\n\t\t\twindow.location.reload();\n\t\t},1000);\n\n\t\t// return newBookDir;\n\t},\n\n\t//获取本地书地址和已读数据\n\tgetLocalUserData(){\n\t\treturn new Promise(function(success,error){\n\t\t\tlet tempData = [\n\t\t\t\t// {name:\"aa\",url:\"http://www.biquge.tw/0_4/\"},\n\t\t\t\t// {name:\"bb\",url:\"http://www.biquge.tw/9_9080/\"}\n\t\t\t];\n\n\n\t\t\tlet data = JSON.parse(DEVICE.localData.getItem(\"cache\") || '{}'),\n\t\t\t\tbooks = data.books || tempData,\n\t\t\t\thasRead = data.hasRead || {};\n\n\t\t\tsuccess({books,hasRead});\n\t\t})\n\t},\n\n\t//获取本地收藏的书的目录\n\tgetLocalBookDirData(){\n\t\treturn new Promise(function(success,error){\n\t\t\tlet bookDir = JSON.parse(DEVICE.localData.getItem(\"bookDir\") || '{}');\n\t\t\tsuccess(bookDir)\n\t\t});\n\t},\n\n\t//获取最新的书的目录\n\tgetNewBookDirData(){\n\t\tlet data = [],\n\t\t\thasRead = {};\n\t\tfor(let i=0,l=DATA.books.length;i<l;i++){\n\t\t\tlet bookUrl = DATA.books[i].url;\n\t\t\tdata.push(bookUrl);\n\n\t\t\tlet bookDir = DATA.booksDir[bookUrl] || [],\n\t\t\t\tbookLength = bookDir.length - 1,\n\t\t\t\tlastPage = bookDir[bookLength] || {};\n\n\t\t\thasRead[bookUrl] = lastPage.url\n\t\t}\n\n\t\treturn new Promise(function(success,error){\n\t\t\tAJAX.go(\"./api/\",{books:data,hasRead:hasRead},success,error)\n\t\t});\n\t},\n\n\n\t//与本地数据合成新的数据\n\treCreateNewBookDirData(data){\n\t\tlet oldData = DATA.booksDir;\n\n\t\treturn new Promise(function(success,error){\n\t\t\tfor(var key in data){\n\t\t\t\tif(data.hasOwnProperty(key)){\n\t\t\t\t\toldData[key].push.apply(oldData[key],data[key]);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tsuccess(oldData);\n\t\t});\n\t},\n\n\t//保存新的书籍的目录数据\n\tsaveNewBookDirData(oldData,data){\n\t\treturn new Promise(function(success,error){\n\t\t\tlet newData = {};\n\t\t\tfor(var key in oldData){\n\t\t\t\tif(oldData.hasOwnProperty(key)){\n\t\t\t\t\tnewData[key] = data[key];\n\t\t\t\t}\n\t\t\t}\n\n\n\t\t\tDEVICE.localData.setItem(\"bookDir\",JSON.stringify(newData));\n\t\t\tsuccess();\n\t\t});\n\t},\n\n\n\t//生成本地书本列表\n\tcreateList(){\n\t\tlet data = DATA.books,\n\t\t\tbody = $(\"#page1_body\"),\n\t\t\tlist = $(\"#page1_list\");\n\n\t\tlet old_list = body.find(\".page1_list\"),\n\t\t\tdels = old_list.find(\".page1_list_del\");\n\t\t$$(old_list).unbind(true);\n\t\t$$(dels).unbind(true);\n\t\t$$$(old_list).unbind(true);\n\t\tbody.html(\"\");\n\n\n\t\tfor(let i=0,l=data.length;i<l;i++){\n\t\t\tlet this_list = list.clone().css3({display:\"box\"}).attr({id:\"\"}),\n\t\t\t\tthis_data = data[i],\n\t\t\t\tnumber = this.getBooksNewDirsNumber(this_data.url);\n\n\t\t\tthis_list.find(\".page1_list_name\").text(this_data.name);\n\t\t\tthis_list.find(\".page1_list_number\").text(number);\n\t\t\tthis_list.data({url:this_data.url}).attr({_id:this_data.url});\n\n\t\t\tbody.append(this_list);\n\t\t\tthis.dirClickEventBind(this_list);\n\t\t}\n\n\t},\n\n\t//获取书的未读章节数量\n\tgetBooksNewDirsNumber(id){\n\t\tlet bookDir = DATA.booksDir[id] || [],\n\t\t\thasRead = DATA.hasRead[id],\n\t\t\tn = 0;\n\n\t\tif(!hasRead){\n\t\t\treturn bookDir.length;\n\t\t}\n\n\n\t\tfor(let i=0,l=bookDir.length;i<l;i++){\n\t\t\tlet this_url = bookDir[i].url;\n\t\t\tif(this_url == hasRead){\n\t\t\t\tn = i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\treturn bookDir.length - 1 - n;\n\t},\n\n\n\t//目录事件绑定\n\tdirClickEventBind(bookList){\n\t\t$$(bookList).myclickok(function(){\n\t\t\tlet url = $(this).data(\"url\"),\n\t\t\t\tname = $(this).find(\".page1_list_name\").text();\n\n\t\t\tPAGE2.init(url,name,\"page1\");\n\t\t});\n\n\t\t$$$(bookList).myslideleft(function(){\n\t\t\t$(this).cssAnimate({\n\t\t\t\ttransform:\"translateX(-60px)\"\n\t\t\t},300)\n\t\t});\n\t\t$$$(bookList).myslideright(function(){\n\t\t\t$(this).cssAnimate({\n\t\t\t\ttransform:\"translateX(0)\"\n\t\t\t},300)\n\t\t});\n\n\t\tlet del = bookList.find(\".page1_list_del\"),\n\t\t\t_this = this;\n\t\t$$(del).myclickok(function(){\n\t\t\tlet url = $(this).parent().data(\"url\");\n\t\t\t_this.delBook(url,$(this).parent());\n\t\t})\n\t},\n\n\t//事件绑定\n\tbindEvent(){\n\t\tlet search = $(\"#page1_search\"),\n\t\t\trefresh = $(\"#page1_refresh\"),\n\t\t\t_this = this;\n\n\t\t$$(search).myclickok(function(){\n\t\t\t_this.openSearchPage();\n\t\t});\n\n\n\t\t$$(refresh).myclickok(function(){\n\t\t\t_this.getNewData().catch(()=>{\n\t\t\t\tDEVICE.info.show(\"更新失败!\");\n\t\t\t});\n\t\t});\n\t},\n\n\n\t//打开搜索页面\n\topenSearchPage(){\n\t\tPAGE4.init(\"page1\");\n\t},\n\n\t//更改未读条数\n\trefreshNotReadNumber(id,number){\n\t\t$(\"#page1_body\").find(\".page1_list_main[_id='\"+id+\"']\").find(\".page1_list_number\").text(number);\n\t},\n\n\t//刷新目录\n\tasync refreshDir(){\n\t\tlet userData =  await this.getLocalUserData();\n\t\tDATA.books = userData.books;\n\t\tDATA.hasRead = userData.hasRead;\n\n\t\tawait this.createList();\n\t},\n\tasync delBook(url,obj){\n\t\tlet userData =  await this.getLocalUserData();\n\t\tlet bookDir = await this.getLocalBookDirData();\n\n\t\tlet books = userData.books,\n\t\t\thasRead = userData.hasRead;\n\n\t\tlet newBooks = [];\n\t\tfor(let i=0,l=books.length;i<l;i++){\n\t\t\tlet this_url = books[i].url;\n\t\t\tif(this_url != url){\n\t\t\t\tnewBooks.push(books[i]);\n\t\t\t}\n\t\t}\n\n\t\tdelete bookDir[url];\n\n\t\tawait this.saveNewBookDirData(bookDir,bookDir);\n\t\tDEVICE.localData.setItem(\"cache\",JSON.stringify({\n\t\t\tbooks:newBooks,\n\t\t\thasRead:hasRead\n\t\t}));\n\n\n\t\tDATA.books = newBooks;\n\t\tDATA.hasRead = hasRead;\n\t\tDATA.booksDir = bookDir;\n\n\t\tobj.remove();\n\n\t\tDEVICE.info.show(\"删除成功!\",true);\n\t},\n\t//检查是否异常关闭\n\tcheckAbnormalClose(){\n\t\tlet temp = JSON.parse(DEVICE.localData.getItem(\"temp\") || '{}'),\n\t\t\tscrollTop = DEVICE.localData.getItem(\"temp_scroll\");\n\n\t\t//判断是否异常关闭\n\t\tif(!temp.title){return;}\n\n\t\t//判断本地缓存中书的详细目录中是否有这个书的地址\n\t\tif(!DATA.booksDir[temp.bookUrl]){return;}\n\n\t\tPAGE2.init(temp.bookUrl,temp.title,\"page1\")\n\t\t\t .then(function(){\n\t\t\t\tPAGE3.init1(\n\t\t\t\t\ttemp.bookUrl,\n\t\t\t\t\ttemp.infoUrl,\n\t\t\t\t\ttemp.title,\n\t\t\t\t\t\"page2\",\n\t\t\t\t\ttemp.n,\n\t\t\t\t\ttemp.text,\n\t\t\t\t\tscrollTop\n\t\t\t\t);\n\t\t\t })\n\t}\n};"]}